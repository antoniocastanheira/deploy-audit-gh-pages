<!DOCTYPE html>
<html lang="en">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, shrink-to-fit=no"
    />

    <!-- Bootstrap CSS -->
    <link
      rel="stylesheet"
      href="https://unpkg.com/bootstrap-material-design@4.1.1/dist/css/bootstrap-material-design.min.css"
      integrity="sha384-wXznGJNEXNG1NFsbm0ugrLFMQPWswR3lds2VeinahP8N0zJw9VWSopbjv2x7WCvX"
      crossorigin="anonymous"
    />

    <link href="http://fonts.cdnfonts.com/css/avenir-lt-std" rel="stylesheet" />

    <link
      rel="stylesheet"
      type="text/css"
      href="https://cdn.datatables.net/v/bs4/dt-1.10.20/datatables.min.css"
    />

    <title>Bridge - NPM Audit Report</title>

    <style>
      * {
        font-family: "Avenir LT Std", sans-serif;
      }

      body {
        background-color: #fff;
        color: #071a32;
      }

      a {
        color: #596778;
        font-weight: 400;
      }

      a:hover {
        color: #008be1;
      }

      h1,
      h2,
      h3 {
        color: #071a32;
        margin: 0;
      }

      h2 {
        font-size: 1.65rem;
        line-height: 1.8rem;
      }

      h3 {
        font-size: 1.35rem;
        line-height: 1.4rem;
      }

      pre {
        padding: 15px;
      }

      pre code {
        color: #e91e63;
      }

      strong {
        font-weight: 600;
      }

      /* Search */
      div.dataTables_wrapper div.dataTables_filter label {
        font-family: "Avenir LT Std", sans-serif;
        text-transform: uppercase;
        margin: 1rem 0;
        width: 100%;
      }

      div.dataTables_wrapper div.dataTables_length label {
        margin: 0;
      }
      div.dataTables_wrapper div.dataTables_filter input {
        font-family: "Avenir LT Std", sans-serif;
        text-rendering: auto;
        color: -internal-light-dark(black, white);
        letter-spacing: normal;
        word-spacing: normal;
        line-height: normal;
        text-transform: none;
        text-indent: 0px;
        text-shadow: none;
        display: inline-block;
        text-align: start;
        appearance: auto;
        -webkit-rtl-ordering: logical;
        cursor: text;
        background-color: -internal-light-dark(
          rgb(255, 255, 255),
          rgb(59, 59, 59)
        );
        margin: 0em;
        padding: 1px 2px;
        border-width: 2px;
        border-style: inset;
        border-color: -internal-light-dark(
          rgb(118, 118, 118),
          rgb(133, 133, 133)
        );
        border-image: initial;
        color: rgb(89, 103, 120);
        font-size: 1.2rem;
        font-weight: normal;
        width: 50%;
        background: transparent;
        border-width: initial;
        border-style: none;
        border-color: initial;
        border-image: initial;
        outline: none;
      }
      /* Badge */

      .badge {
        display: inline-flex;
        align-items: center;
        line-height: 1rem;
        font-weight: bold;
        font-size: 0.75rem;
        text-transform: uppercase;
        border-radius: 0.25rem;
        padding: 0.25rem 0.5rem;
      }

      .badge-danger {
        background-color: rgba(248, 84, 57, 0.86);
      }

      .badge-warning {
        color: rgb(248, 84, 57);
        background-color: rgba(248, 84, 57, 0.16);
      }

      .badge-secondary {
        color: rgb(7, 26, 50);
        background-color: rgb(232, 235, 241);
      }

      .badge-primary {
        color: rgb(171, 127, 0);
        background-color: rgba(246, 206, 105, 0.16);
      }

      .badge-info {
        color: rgb(0, 139, 225);
        background-color: rgba(0, 139, 225, 0.16);
      }

      .custom-button {
        appearance: none;
        cursor: pointer;
        display: inline-block;
        font-family: inherit;
        font-size: 0.75rem;
        font-weight: bold;
        letter-spacing: 0.0625rem;
        line-height: 1rem;
        position: relative;
        text-align: center;
        text-transform: uppercase;
        background: transparent;
        border-width: 0.0625rem;
        border-style: solid;
        border-color: transparent;
        border-image: initial;
        border-radius: 3rem;
        margin: 0px;
        overflow: visible;
        padding: 0.625rem 1.25rem 0.5rem;
        text-decoration: none;
        transition: all 0.2s ease 0s;
      }

      .custom-button:hover {
        border-color: transparent;
        text-decoration: none;
      }

      .btn-primary {
        color: rgb(0, 139, 225);
        border-color: rgb(0, 139, 225);
      }

      .btn-primary:hover {
        box-shadow: rgb(0, 139, 225) 0px 0px 0px 0.125rem;
        background-color: rgb(0, 139, 225);
      }

      .btn-secondary {
        color: rgb(89, 103, 120);
        border-color: rgb(136, 147, 162);
      }

      .link {
        color: rgb(0, 139, 225);
        text-decoration: underline;
      }

      .link:hover,
      .link:focus {
        color: rgb(1, 111, 180);
        text-decoration-thickness: 0.125rem;
      }

      /* Modal */

      .modal-footer {
        justify-content: space-between;
      }

      .modal-content .modal-footer {
        padding: 24px;
      }
      /* Chip */
      .chip {
        align-items: center;
        background-color: rgb(255, 255, 255);
        box-sizing: border-box;
        color: rgb(7, 26, 50);
        display: inline-flex;
        font-size: 0.875rem;
        max-width: 100%;
        text-align: left;
        vertical-align: middle;
        word-break: keep-all;
        border-width: 0.0625rem;
        border-style: solid;
        border-color: rgb(232, 235, 241);
        border-radius: 0.25rem;
        outline: 0px;
        padding: 0.5rem;
        margin: 0.5rem 0;
      }

      /* Pagination */

      .page-item.active .page-link {
        z-index: 1;
        color: #fff;
        background-color: rgb(0, 139, 225);
        border-color: none;
        box-shadow: rgb(0, 139, 225) 0px 0px 0px 0.125rem;
      }

      .page-link:hover {
        color: rgb(0, 139, 225);
      }
      
      .page-link:focus {
        z-index: 2;
        outline: 0;
        box-shadow: rgb(0, 139, 225) 0px 0px 0px 0.125rem;
      }

      .page-link {
        color: rgb(0, 139, 225);
      }
      /* Card  */
      .card {
        position: relative;
        background-color: rgb(255, 255, 255);
        box-shadow: rgba(7, 26, 50, 0.15) 0px 0.0625rem 0.125rem 0px,
          rgba(7, 26, 50, 0.1) 0px 0.0625rem 0.1875rem 0px;
        display: flex;
        flex-direction: column;
        top: 0px;
        left: 0px;
        border-radius: 0.25rem;
        transition: height 0.1s linear 0s, width 0.1s linear 0s,
          left 0.1s linear 0s, top 0.1s linear 0s;
      }

      .card h5.card-title {
        font-size: 1.7rem;
        font-weight: 400;
      }

      .card-body {
        flex: 1 1 auto;
        padding: 1.25rem;
        align-items: center;
        justify-content: center;
        display: flex;
        flex-direction: column;
      }

      /* Table */
      .table {
        background-color: #fff;
        border-collapse: collapse;
        border-spacing: 0;
        font-size: 1rem;
        width: 100%;
        color: #596778;
        box-shadow: rgba(7, 26, 50, 0.15) 0px 0.0625rem 0.125rem 0px,
          rgba(7, 26, 50, 0.1) 0px 0.0625rem 0.1875rem 0px;
        border-radius: 0.25rem;
        transition: height 0.1s linear 0s, width 0.1s linear 0s,
          left 0.1s linear 0s, top 0.1s linear 0s;
      }

      .tr-main {
        background-color: #f6f7f9;
      }

      .tr,
      .td {
        border-bottom: 0.0625rem solid #e8ebf1;
      }

      .thead .tr {
        border-bottom: none;
      }

      tr:hover {
        background-color: #f6f7f9;
      }

      .th {
        font-size: 0.875rem;
        font-weight: normal;
        text-transform: uppercase;
      }

      .td,
      .th {
        padding: 1rem 1.75rem;
        text-align: left;
        vertical-align: middle;
      }

      .td:focus {
        font-weight: bold;
        outline: none;
      }
    </style>
  </head>

  <body class="mb-3">
    <div class="container">
      <div class="row my-4">
        <div class="col">
          <img
            width="300"
            height="91"
            src="https://3pcnzm2kcgmb1zhk5p3s81xf-wpengine.netdna-ssl.com/wp-content/uploads/2020/07/bridge.png"
          />
        </div>
        <div class="col d-flex align-items-center">
          <h2>deploy-audit-gh-pages</h2>
        </div>
      </div>
      <div class="text-center">
        <div class="card-deck my-3">
          <div class="card">
            <div class="card-body">
              <h5 class="card-title">
                {{numeral metadata.vulnerabilities.total "0,0"}}
              </h5>
              <p class="card-text">Known vulnerabilities</p>
            </div>
          </div>
          <div class="card">
            <div class="card-body">
              <h5 class="card-title">
                {{numeral metadata.totalDependencies "0,0"}}
              </h5>
              <p class="card-text">Dependencies</p>
            </div>
          </div>
          <div class="card">
            <div class="card-body">
              <h5 class="card-title">
                {{moment date "MMMM Do YYYY, h:mm:ss a"}}
              </h5>
              <p class="card-text">Last updated</p>
            </div>
          </div>
        </div>
        <div class="card-deck my-3">
          <div class="card">
            <div class="card-body">
              <h5 class="card-title">
                {{numeral metadata.vulnerabilities.critical "0,0"}}
              </h5>
              <p class="card-text">
                <span class="badge badge-{{severityClass 'critical'}}"
                  >critical</span
                >
              </p>
            </div>
          </div>
          <div class="card">
            <div class="card-body">
              <h5 class="card-title">
                {{numeral metadata.vulnerabilities.high "0,0"}}
              </h5>
              <p class="card-text">
                <span class="badge badge-{{severityClass 'high'}}">high</span>
              </p>
            </div>
          </div>
          <div class="card">
            <div class="card-body">
              <h5 class="card-title">
                {{numeral metadata.vulnerabilities.moderate "0,0"}}
              </h5>
              <p class="card-text">
                <span class="badge badge-{{severityClass 'moderate'}}"
                  >moderate</span
                >
              </p>
            </div>
          </div>
          <div class="card">
            <div class="card-body">
              <h5 class="card-title">
                {{numeral metadata.vulnerabilities.low "0,0"}}
              </h5>
              <p class="card-text">
                <span class="badge badge-{{severityClass 'low'}}">low</span>
              </p>
            </div>
          </div>
          <div class="card">
            <div class="card-body">
              <h5 class="card-title">
                {{numeral metadata.vulnerabilities.info "0,0"}}
              </h5>
              <p class="card-text">
                <span class="badge badge-{{severityClass 'info'}}">info</span>
              </p>
            </div>
          </div>
        </div>
      </div>

      <div class="row">
        <div class="col">
          <table id="advisories" class="table">
            <thead>
              <tr class="tr-main">
                <th scope="col">Name</th>
                <th scope="col">Module</th>
                <th scope="col">Severity</th>
                <th scope="col">CVEs</th>
              </tr>
            </thead>
            <tbody>
              {{#each advisories}}
              <tr>
                <th scope="row">
                  <a
                    href="{{ url }}"
                    data-toggle="modal"
                    data-target="#advisory-modal-{{ id }}"
                    >{{ title }}</a
                  >
                </th>
                <td>
                  <a
                    href="https://npmjs.com/package/{{ module_name }}"
                    target="_blank"
                    rel="noopener"
                    >{{ module_name }}</a
                  >
                </td>
                <td data-order="{{severityNumber severity}}">
                  <span class="badge badge-{{severityClass severity}}">{{
                    severity
                  }}</span>
                </td>
                <td>
                  {{ cwe }}
                  {{#each cves}}
                  , {{ this }}
                  {{/each}}
                </td>
              </tr>
              {{/each}}
            </tbody>
          </table>
        </div>
      </div>
    </div>

    {{#each advisories}}
    <div class="modal" tabindex="-1" role="dialog" id="advisory-modal-{{ id }}">
      <div class="modal-dialog modal-lg" role="document">
        <div class="modal-content">
          <div class="modal-header">
            <div class="d-flex align-items-start flex-column">
              <span class="badge mb-2 badge-{{severityClass severity}}">{{
                severity
              }}</span>

              <h2 class="modal-title">
                {{ title }}
              </h2>
            </div>

            <button
              type="button"
              class="close"
              data-dismiss="modal"
              aria-label="Close"
            >
              <span aria-hidden="true">&times;</span>
            </button>
          </div>
          <div class="modal-body">
            <div class="row">
              <div class="col-md-6">
                <ul>
                  <li>
                    <strong> Module: </strong>
                    <a
                      href="https://npmjs.com/package/{{ module_name }}"
                      target="_blank"
                      rel="noopener"
                      >{{ module_name }}</a
                    >
                  </li>
                  <li>
                    <strong> Published: </strong>
                    {{moment created "MMMM Do YYYY"}}
                  </li>
                  <li>
                    <strong> Reported by: </strong>
                    {{ reported_by.name }}
                  </li>
                  <li>{{ cwe }}</li>
                  {{#each cves}}
                  <li>{{ this }}</li>
                  {{/each}}
                </ul>
              </div>
              <div class="col-md-6">
                <ul>
                  <li>
                    <strong> Vulnerable: </strong>
                    {{ vulnerable_versions }}
                  </li>
                  <li>
                    <strong> Patched: </strong>
                    {{ patched_versions }}
                  </li>
                  <li>
                    <strong> Exploitability: </strong>
                    {{ metadata.exploitability }}
                  </li>
                </ul>
              </div>
            </div>
            <h3>Overview</h3>
            <p class="card-text">{{{markdown overview}}}</p>

            <h3>Findings</h3>
            {{#each findings}}
            <ul class="m-0 p-0">
              {{#each paths}}
              <li class="chip">
                {{ this }}
              </li>
              {{/each}}
            </ul>
            {{/each}}

            {{#if recommendation}}
            <h3>Remediation</h3>
            <p class="card-text">{{{markdown recommendation}}}</p>
            {{/if}} {{#if references}}
            <h3>References</h3>
            <p class="card-text">{{{markdown references}}}</p>
            {{/if}} {{#if action}}
            <h3>Action</h3>
            <p class="card-text">
              <code
                >npm {{ action.action }} {{ action.module }}
                {{#if action.depth}}--depth={{ action.depth }}{{/if}}</code
              >
            </p>
            {{/if}}
          </div>
          <div class="modal-footer">
            <a class="link" href="{{ url }}" target="_blank" rel="noopener"
              >More about this vulnerability</a
            >
            <button
              type="button"
              class="custom-button btn-primary"
              data-dismiss="modal"
            >
              Close
            </button>
          </div>
        </div>
      </div>
    </div>
    {{/each}}

    <script
      src="https://code.jquery.com/jquery-3.3.1.slim.min.js"
      integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo"
      crossorigin="anonymous"
    ></script>
    <script
      src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"
      integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM"
      crossorigin="anonymous"
    ></script>
    <script
      type="text/javascript"
      src="https://cdn.datatables.net/v/bs4/dt-1.10.20/datatables.min.js"
    ></script>

    <script>
      $(document).ready(function () {
        $("#advisories").DataTable({
          order: [[1, "asc"]],
          dom:
            "<'row'<'col-sm-12 col-md-8'f><'col-sm-12 col-md-4 d-flex align-items-center justify-content-end'l>>" +
            "<'row'<'col-sm-12'tr>>" +
            "<'row'<'col-sm-12 col-md-5'i><'col-sm-12 col-md-7'p>>",
        });
      });
    </script>
  </body>
</html>
